; Water Level Sensor - Wemos D1 Mini + HC-SR04
[env:d1_mini]
platform = espressif8266
board = d1_mini
framework = arduino
board_build.filesystem = littlefs
board_build.ldscript = eagle.flash.4m1m.ld   ; 3MB code + 1MB LittleFS

monitor_speed = 115200
upload_speed = 115200

lib_deps =
  knolleary/PubSubClient @ ^2.8
  bblanchon/ArduinoJson @ ^6.21
  witnessmenow/UniversalTelegramBot @ ^1.3.0
  paulstoffregen/OneWire @ ^2.3.7
  milesburton/DallasTemperature @ ^3.11.0
  ESP8266WebServer
  ESP8266HTTPUpdateServer

build_flags =
  -D ASYNC_TCP_SSL_ENABLED=0
  -Os
  ; Embed git tag as FW_VERSION at build time.
  ; Falls back to "dev" when no tags exist (fresh clone, CI without tags).
  !python -c "import subprocess,sys; tag=subprocess.getoutput('git describe --tags --abbrev=0 2>/dev/null').strip(); v=tag.lstrip('v') if tag.startswith('v') else 'dev'; sys.stdout.write('-DFW_VERSION=\\\"'+v+'\\\"')"
